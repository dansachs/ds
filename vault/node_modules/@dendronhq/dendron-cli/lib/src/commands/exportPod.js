"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.ExportPodCLICommand = void 0;
const pods_core_1 = require("@dendronhq/pods-core");
const base_1 = require("./base");
const pod_1 = require("./pod");
const utils_1 = require("./utils");
class ExportPodCLICommand extends base_1.CLICommand {
    constructor() {
        super({
            name: "exportPod",
            desc: "use a pod to export notes",
        });
    }
    buildArgs(args) {
        super.buildArgs(args);
        utils_1.setupEngineArgs(args);
        pod_1.setupPodArgs(args);
    }
    async enrichArgs(args) {
        return pod_1.enrichPodArgs({ pods: pods_core_1.getAllExportPods(), podType: "export" })(args);
    }
    static getPods() {
        return pods_core_1.getAllExportPods();
    }
    async execute(opts) {
        const { podClass: PodClass, config, wsRoot, engine, server } = opts;
        const vaults = engine.vaults;
        const pod = new PodClass();
        console.log("running pod...");
        await pod.execute({ wsRoot, config, engine, vaults });
        server.close((err) => {
            if (err) {
                this.L.error({ msg: "error closing", payload: err });
            }
        });
        console.log("done");
    }
}
exports.ExportPodCLICommand = ExportPodCLICommand;
//# sourceMappingURL=exportPod.js.map